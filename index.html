<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ç¦æ°”ç ”ç©¶æ‰€ Â· çµæ„Ÿå£çº¸</title>
<style>
/* --- 1. åŸºç¡€å¸ƒå±€ --- */
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
    font-family: 'Georgia', serif;
    background: linear-gradient(160deg, #fff8f0 0%, #fdebd0 60%, #fff0e8 100%);
    min-height: 100vh;
    color: #5a2a10;
    display: flex; flex-direction: column; align-items: center;
}

header { text-align: center; padding: 36px 20px 10px; width: 100%; }
.logo { font-size: 2rem; font-weight: 900; color: #c0380a; letter-spacing: 8px; text-shadow: 0 2px 12px #ffcc8050; }
.sub  { font-size: 0.78rem; color: #e07030; letter-spacing: 4px; margin-top: 6px; }

/* --- 2. æ’ä»¶åŠŸèƒ½æ  (éŸ³ä¹+æŠ½ç­¾) --- */
.plugin-bar {
    display: flex; justify-content: center; gap: 12px; 
    padding: 15px; width: 100%; max-width: 600px;
}
.plugin-btn {
    flex: 1; height: 45px; border-radius: 50px;
    border: 1.5px solid #ffb07a; background: #fff;
    color: #c0380a; cursor: pointer; font-size: 0.85rem;
    display: flex; align-items: center; justify-content: center;
    box-shadow: 0 4px 10px rgba(192,56,10,0.1); transition: all 0.2s;
    font-family: inherit;
}
.plugin-btn:hover { background: #fff3e0; transform: translateY(-2px); }

/* --- 3. æœç´¢ä¸æ ‡ç­¾ --- */
.search-wrap {
    width: 100%; max-width: 560px; padding: 10px 20px;
    display: flex; flex-direction: column; align-items: center; gap: 15px;
}
.search-row { display: flex; width: 100%; gap: 10px; }
.search-row input {
    flex: 1; padding: 13px 22px; border-radius: 50px;
    border: 2px solid #ffb07a; background: #fffaf5; outline: none;
    font-size: 0.95rem; font-family: inherit;
}
.search-row button {
    padding: 13px 26px; border-radius: 50px; border: none;
    background: linear-gradient(135deg, #ff6b35, #c0380a);
    color: #ffd740; font-weight: bold; cursor: pointer;
    box-shadow: 0 4px 16px #c0380a35; font-family: inherit;
}

.tags { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; }
.tag { 
    padding: 6px 16px; border-radius: 50px; border: 1px solid #ffb07a; 
    font-size: 0.78rem; cursor: pointer; background: #fff3e0; color: #b03000;
}
.tag.active { background: #c0380a; color: #ffd740; border-color: #c0380a; }

/* --- 4. ç”»å»Šå¸ƒå±€ --- */
.loading { display: none; text-align: center; padding: 30px; color: #c0380a; }
.spinner { width: 30px; height: 30px; border: 3px solid #ffd0a0; border-top-color: #c0380a; border-radius: 50%; animation: spin 0.8s linear infinite; margin: 0 auto 10px; }
@keyframes spin { to { transform: rotate(360deg); } }

.gallery {
    display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 25px; width: 100%; max-width: 1000px; padding: 20px 20px 60px;
}
.card { cursor: pointer; transition: transform 0.2s; display: flex; flex-direction: column; align-items: center;}
.card:hover { transform: translateY(-5px); }
.phone {
    position: relative; width: 140px; height: 280px; background: #0e0e0e;
    border-radius: 24px; border: 3px solid #2a2a2a; overflow: hidden;
    box-shadow: 0 10px 30px #0003;
}
.phone-img { width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: opacity 0.5s; }
.phone-img.loaded { opacity: 1; }
.lock-ov { position: absolute; inset: 0; z-index: 5; text-align: center; padding-top: 30px; color: #fff; pointer-events: none; }

/* --- 5. æŠ½ç­¾å¼¹çª— --- */
#draw-overlay {
    display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85);
    z-index: 1000; align-items: center; justify-content: center; backdrop-filter: blur(5px);
}
.stick-container { 
    width: 60px; height: 100px; background: #c0380a; border-radius: 8px; 
    animation: shake 0.5s infinite; border: 2px solid #ffd740;
}
@keyframes shake { 0%, 100% { transform: rotate(0); } 25% { transform: rotate(15deg); } 75% { transform: rotate(-15deg); } }
.stick-result { 
    background: #fff8f0; padding: 30px; border-radius: 20px; text-align: center; 
    border: 4px solid #c0380a; display: none;
}
</style>
</head>
<body>

<header>
    <div class="logo">ç¦æ°”ç ”ç©¶æ‰€</div>
    <div class="sub">âœ¦ æ‰‹æœºå£çº¸çµæ„Ÿåº“ âœ¦</div>
</header>

<div class="plugin-bar">
    <select id="bgm-player" class="plugin-btn" onchange="changeMusic()">
        <option value="">ğŸµ èƒŒæ™¯éŸ³ä¹</option>
        <option value="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3">æ¸…ä¿®ç¦…éŸ³</option>
        <option value="https://assets.mixkit.co/music/preview/mixkit-zen-meditation-431.mp3">å†¥æƒ³ç™½å™ª</option>
    </select>
    <button class="plugin-btn" onclick="startDraw()">ğŸ‹ æ¯æ—¥æŠ½ç­¾ (ç›²ç›’)</button>
</div>

<div class="search-wrap">
    <div class="search-row">
        <input id="kw" type="text" placeholder="è¾“å…¥å…³é”®è¯ï¼Œå¦‚ 'é‡‘é¾™'"/>
        <button onclick="doSearch()">ç”Ÿæˆ</button>
    </div>
    <div class="tags" id="tags"></div>
</div>

<div class="loading" id="loading"><div class="spinner"></div>æ­£åœ¨å¬å”¤å¥½è¿...</div>
<div class="gallery" id="gallery"></div>

<div id="draw-overlay" onclick="this.style.display='none'">
    <div class="stick-container" id="stick-box"></div>
    <div class="stick-result" id="stick-result">
        <h2 style="color:#c0380a">ä¸Šä¸Šç­¾</h2>
        <p id="luck-text" style="margin:15px 0; font-weight:bold"></p>
        <p style="font-size:0.8rem; color:#e07030">å·²ä¸ºä½ è‡ªåŠ¨åŒ¹é…å£çº¸ âœ¨</p>
    </div>
</div>

<audio id="audio-element" loop></audio>

<script>
const TAGS = [
    { label: 'ğŸ”´ Lucky Koi', prompt: 'red and gold koi fish, traditional painting' },
    { label: 'ğŸ‰ Golden Dragon', prompt: 'majestic golden dragon in clouds' },
    { label: 'ğŸŒ¸ Peach Blossom', prompt: 'pink peach blossoms, misty background' },
    { label: 'ğŸ‹ Bamboo Luck', prompt: 'green bamboo forest, zen style' }
];

// åˆå§‹åŒ–æ ‡ç­¾
const tagWrap = document.getElementById('tags');
TAGS.forEach(t => {
    const el = document.createElement('span');
    el.className = 'tag';
    el.textContent = t.label;
    el.onclick = () => {
        document.getElementById('kw').value = t.label;
        doSearch();
    };
    tagWrap.appendChild(el);
});

function doSearch() {
    const kw = document.getElementById('kw').value;
    if(!kw) return;
    const matched = TAGS.find(t => t.label.includes(kw));
    const prompt = matched ? matched.prompt : kw + ", auspicious style";
    generate(prompt, kw);
}

function generate(prompt, label) {
    document.getElementById('loading').style.display='block';
    const gallery = document.getElementById('gallery');
    gallery.innerHTML = '';
    
    for (let i=0; i<6; i++) {
        const seed = Math.floor(Math.random()*999999);
        const url = `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt + ", phone wallpaper 9:16")}?width=1080&height=1920&seed=${seed}&nologo=true`;
        
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `<div class="phone"><img class="phone-img" src="${url}" onload="this.classList.add('loaded')"><div class="lock-ov">12:00</div></div>`;
        gallery.appendChild(card);
    }
    document.getElementById('loading').style.display='none';
}

function changeMusic() {
    const p = document.getElementById('audio-element');
    const s = document.getElementById('bgm-player').value;
    if(s){ p.src=s; p.play(); } else { p.pause(); }
}

function startDraw() {
    const ov = document.getElementById('draw-overlay');
    const box = document.getElementById('stick-box');
    const res = document.getElementById('stick-result');
    ov.style.display = 'flex'; box.style.display = 'block'; res.style.display = 'none';
    
    setTimeout(() => {
        box.style.display = 'none';
        const luck = TAGS[Math.floor(Math.random()*TAGS.length)];
        document.getElementById('luck-text').innerText = "ä»Šæ—¥å®œï¼š" + luck.label;
        res.style.display = 'block';
        document.getElementById('kw').value = luck.label;
        doSearch();
    }, 1200);
}
</script>
</body>
</html>
